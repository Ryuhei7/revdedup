\hypertarget{delete_8c}{\section{delete.\-c \-File \-Reference}
\label{delete_8c}\index{delete.\-c@{delete.\-c}}
}


\-Implements bucket deletion with version tagged.  


{\ttfamily \#include $<$revdedup.\-h$>$}\*
{\ttfamily \#include $<$queue.\-h$>$}\*
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structSimpleSegment}{\-Simple\-Segment}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structBucket}{\-Bucket} $\ast$ \hyperlink{delete_8c_aa91b1e9cced772edc3d3ce7dfc7d070c}{\-New\-Bucket} ()
\item 
static void \hyperlink{delete_8c_af0899e4dd22c1fd81697558bc38d3bf8}{\-Save\-Bucket} (\hyperlink{structBucket}{\-Bucket} $\ast$b)
\item 
static \hyperlink{structBucket}{\-Bucket} $\ast$ \hyperlink{delete_8c_a74fcc5d4e43d8c454f367b29539e4543}{\-Bucket\-Insert} (\hyperlink{structBucket}{\-Bucket} $\ast$b, \hyperlink{structSimpleSegment}{\-Simple\-Segment} $\ast$sseg)
\item 
static void $\ast$ \hyperlink{delete_8c_a75f4c029c2eb631c3c9b3c78c6cf7d90}{process} (void $\ast$ptr)
\item 
int \hyperlink{delete_8c_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\subsection*{\-Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{delete_8c_af300154ee884b0a273fba0373e0c7c29}{\hyperlink{structSMEntry}{\-S\-M\-Entry} $\ast$ {\bfseries sen}}\label{delete_8c_af300154ee884b0a273fba0373e0c7c29}

\item 
\hypertarget{delete_8c_a8033be02f23abd9bfd687b5ae609d04d}{\hyperlink{structBMEntry}{\-B\-M\-Entry} $\ast$ {\bfseries ben}}\label{delete_8c_a8033be02f23abd9bfd687b5ae609d04d}

\item 
\hypertarget{delete_8c_aa298c80939eed3b208ac687ed7cb4e06}{uint8\-\_\-t {\bfseries padding} \mbox{[}\hyperlink{revdedup_8h_ad51ded0bbd705f02f73fc60c0b721ced}{\-B\-L\-O\-C\-K\-\_\-\-S\-I\-Z\-E}\mbox{]}}\label{delete_8c_aa298c80939eed3b208ac687ed7cb4e06}

\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Implements bucket deletion with version tagged. \begin{DoxyAuthor}{\-Author}
\-Ng \-Chun \-Ho 
\end{DoxyAuthor}


\subsection{\-Function \-Documentation}
\hypertarget{delete_8c_a74fcc5d4e43d8c454f367b29539e4543}{\index{delete.\-c@{delete.\-c}!\-Bucket\-Insert@{\-Bucket\-Insert}}
\index{\-Bucket\-Insert@{\-Bucket\-Insert}!delete.c@{delete.\-c}}
\subsubsection[{\-Bucket\-Insert}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf \-Bucket}$\ast$ {\bf \-Bucket\-Insert} (
\begin{DoxyParamCaption}
\item[{{\bf \-Bucket} $\ast$}]{b, }
\item[{{\bf \-Simple\-Segment} $\ast$}]{sseg}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{delete_8c_a74fcc5d4e43d8c454f367b29539e4543}
\-Insert a segment into buckets 
\begin{DoxyParams}{\-Parameters}
{\em b} & \hyperlink{structBucket}{\-Bucket} to insert \\
\hline
{\em sseg} & \hyperlink{structSegment}{\-Segment} to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\hyperlink{structBucket}{\-Bucket} for subsequent insertion 
\end{DoxyReturn}
\hypertarget{delete_8c_a0ddf1224851353fc92bfbff6f499fa97}{\index{delete.\-c@{delete.\-c}!main@{main}}
\index{main@{main}!delete.c@{delete.\-c}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf main} (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{delete_8c_a0ddf1224851353fc92bfbff6f499fa97}
\-Rewrites segments with positive reference count \hypertarget{delete_8c_aa91b1e9cced772edc3d3ce7dfc7d070c}{\index{delete.\-c@{delete.\-c}!\-New\-Bucket@{\-New\-Bucket}}
\index{\-New\-Bucket@{\-New\-Bucket}!delete.c@{delete.\-c}}
\subsubsection[{\-New\-Bucket}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf \-Bucket}$\ast$ {\bf \-New\-Bucket} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{delete_8c_aa91b1e9cced772edc3d3ce7dfc7d070c}
\-Create a new bucket in memory \begin{DoxyReturn}{\-Returns}
\-Created bucket 
\end{DoxyReturn}
\hypertarget{delete_8c_a75f4c029c2eb631c3c9b3c78c6cf7d90}{\index{delete.\-c@{delete.\-c}!process@{process}}
\index{process@{process}!delete.c@{delete.\-c}}
\subsubsection[{process}]{\setlength{\rightskip}{0pt plus 5cm}static void$\ast$ {\bf process} (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{delete_8c_a75f4c029c2eb631c3c9b3c78c6cf7d90}
\-Main loop for processing segments 
\begin{DoxyParams}{\-Parameters}
{\em ptr} & useless \\
\hline
\end{DoxyParams}
\hypertarget{delete_8c_af0899e4dd22c1fd81697558bc38d3bf8}{\index{delete.\-c@{delete.\-c}!\-Save\-Bucket@{\-Save\-Bucket}}
\index{\-Save\-Bucket@{\-Save\-Bucket}!delete.c@{delete.\-c}}
\subsubsection[{\-Save\-Bucket}]{\setlength{\rightskip}{0pt plus 5cm}static void {\bf \-Save\-Bucket} (
\begin{DoxyParamCaption}
\item[{{\bf \-Bucket} $\ast$}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{delete_8c_af0899e4dd22c1fd81697558bc38d3bf8}
\-Seal the bucket on disk 
\begin{DoxyParams}{\-Parameters}
{\em b} & \hyperlink{structBucket}{\-Bucket} to seal \\
\hline
\end{DoxyParams}
